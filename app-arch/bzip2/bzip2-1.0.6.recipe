SUMMARY="bzip2 data compression utilities and libraries"
DESCRIPTION="bzip2 is a freely available, patent free (see below), high-quality data compressor. It typically compresses files to within 10% to 15% of the best available techniques (the PPM family of statistical compressors), whilst being around twice as fast at compression and six times faster at decompression."
HOMEPAGE="http://www.bzip.org/"
LICENSE="bzip2"
COPYRIGHT="1996-2010 Julian R Seward"
SRC_URI="http://www.bzip.org/1.0.6/bzip2-1.0.6.tar.gz"
CHECKSUM_MD5="00b516f4704d4a7cb50a1d97e6e8e15b"
REVISION="3"
ARCHITECTURES="x86_gcc2 x86"

PROVIDES="
	bzip2 = $portVersion compat >= 1
	cmd:bzcat = $portVersion compat >= 1
	cmd:bzcmp = $portVersion compat >= 1
	cmd:bzdiff = $portVersion compat >= 1
	cmd:bzegrep = $portVersion compat >= 1
	cmd:bzfgrep = $portVersion compat >= 1
	cmd:bzgrep = $portVersion compat >= 1
	cmd:bzip2 = $portVersion compat >= 1
	cmd:bzip2recover = $portVersion compat >= 1
	cmd:bzless = $portVersion compat >= 1
	cmd:bzmore = $portVersion compat >= 1
	cmd:bunzip2 = $portVersion compat >= 1
	lib:libbz2 = $portVersion compat >= 1.0
	"
REQUIRES="
	haiku >= $haikuVersion
	"
BUILD_REQUIRES="
	"
BUILD_PREREQUIRES="
	haiku_devel >= $haikuVersion
	cmd:ar
	cmd:gcc
	cmd:ld
	cmd:make
	cmd:sed
	"

SOURCE_DIR="$portVersionedName"

BUILD()
{
	make $jobArgs
	make $jobArgs -f Makefile-libbz2_so
		# shared libary not built by default
}

INSTALL()
{
	make install PREFIX=$prefix

	# also install shared lib
	cp -a libbz2.so.1.0.6 libbz2.so.1.0 $libDir

	# move man pages
	mkdir -p $manDir
	mv $prefix/man/* $manDir
	rmdir $prefix/man

	# move headers
	bzip2IncludeDir=$includeDir/bzip2
	mkdir -p $bzip2IncludeDir
	mv $prefix/include/* $bzip2IncludeDir
	rmdir $prefix/include

	# prepare development lib links 
	prepareInstalledDevelLibs libbz2

	# devel package
	packageEntries devel \
		$developDir
}

# ----- devel package -------------------------------------------------------

PROVIDES_devel="
	bzip2_devel = $portVersion compat >= 1
	devel:libbz2 = $portVersion compat >= 1.0
	"
REQUIRES_devel="
	bzip2 == $portVersion base
	"
