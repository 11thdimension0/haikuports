From ab052deefe2d7bb24449c4f0c2baf536551ef43c Mon Sep 17 00:00:00 2001
From: Adrien Destugues <pulkomandy@gmail.com>
Date: Fri, 17 Oct 2014 13:22:16 +0200
Subject: port php 5.3 patch from 2011.


diff --git a/ext/date/php_date.c b/ext/date/php_date.c
index 64a40a2..6b0d782 100644
--- a/ext/date/php_date.c
+++ b/ext/date/php_date.c
@@ -33,8 +33,6 @@
 
 #ifdef PHP_WIN32
 static __inline __int64 php_date_llabs( __int64 i ) { return i >= 0? i: -i; }
-#elif defined(__GNUC__) && __GNUC__ < 3
-static __inline __int64_t php_date_llabs( __int64_t i ) { return i >= 0 ? i : -i; }
 #else
 static inline long long php_date_llabs( long long i ) { return i >= 0 ? i : -i; }
 #endif
diff --git a/ext/standard/microtime.c b/ext/standard/microtime.c
index fe22366..14298fb 100644
--- a/ext/standard/microtime.c
+++ b/ext/standard/microtime.c
@@ -131,7 +131,7 @@ PHP_FUNCTION(getrusage)
 	array_init(return_value);
 #define PHP_RUSAGE_PARA(a) \
 		add_assoc_long(return_value, #a, usg.a)
-#if !defined( _OSD_POSIX) && !defined(__BEOS__) /* BS2000 has only a few fields in the rusage struct */
+#if !defined( _OSD_POSIX) && !defined(__BEOS__) && !defined(__HAIKU__) /* BS2000 has only a few fields in the rusage struct */
 	PHP_RUSAGE_PARA(ru_oublock);
 	PHP_RUSAGE_PARA(ru_inblock);
 	PHP_RUSAGE_PARA(ru_msgsnd);
-- 
1.8.3.4

