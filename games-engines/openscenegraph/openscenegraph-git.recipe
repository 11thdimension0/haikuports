SUMMARY="An open source, real-time graphics middle-ware used by developers"
DESCRIPTION="
The OpenSceneGraph is an open source high performance 3D graphics toolkit, used \
by application developers in fields such as visual simulation, games, virtual \
reality, scientific visualization and modelling. Written entirely in Standard \
C++ and OpenGL it runs on all Windows platforms, OSX, GNU/Linux, IRIX, Solaris \
, HP-Ux, AIX and FreeBSD operating systems. The OpenSceneGraph is now well \
established as the world leading scene graph technology, used widely in the \ 
vis-sim, space, scientific, oil-gas, games and virtual reality industries."
HOMEPAGE="http://www.openscenegraph.org"
SRC_URI="git://github.com/openscenegraph/osg#77f09f9e649cfedd32608ed6ec67bf1de7cd53ac"
REVISION="1"
LICENSE="OSGPL"
COPYRIGHT="2002-2014 Robert Osfield and others"

ARCHITECTURES="x86 ?x86_64"
if [ $effectiveTargetArchitecture != x86_gcc2 ]; then
	# x86_gcc2 is fine as primary target architecture as long as we're building
	# for a different secondary architecture.
	ARCHITECTURES="$ARCHITECTURES x86_gcc2"
else
	ARCHITECTURES="$ARCHITECTURES !x86_gcc2"
fi
SECONDARY_ARCHITECTURES="x86"

PROVIDES="
	openscenegraph$secondaryArchSuffix = $portVersion
	lib:libOpenThreads$secondaryArchSuffix = $portVersion
	lib:libosg$secondaryArchSuffix = $portVersion
	lib:libosgAnimation$secondaryArchSuffix = $portVersion
	lib:libosgDB$secondaryArchSuffix = $portVersion
	lib:libosgFX$secondaryArchSuffix = $portVersion
	lib:libosgGA$secondaryArchSuffix = $portVersion
	lib:libosgManipulator$secondaryArchSuffix = $portVersion
	lib:libosgParticle$secondaryArchSuffix = $portVersion
	lib:libosgPresentation$secondaryArchSuffix = $portVersion
	lib:libosgShadow$secondaryArchSuffix = $portVersion
	lib:libosgSim$secondaryArchSuffix = $portVersion
	lib:libosgTerrain$secondaryArchSuffix = $portVersion
	lib:libosgText$secondaryArchSuffix = $portVersion
	lib:libosgUtil$secondaryArchSuffix = $portVersion
	lib:libosgViewer$secondaryArchSuffix = $portVersion
	lib:libosgVolume$secondaryArchSuffix = $portVersion
	lib:libosgWidget$secondaryArchSuffix = $portVersion
	lib:libosgUI$secondaryArchSuffix = $portVersion
"

REQUIRES="
	haiku$secondaryArchSuffix
	mesa$secondaryArchSuffix
	lib:libGL$secondaryArchSuffix
	lib:libsdl$secondaryArchSuffix
	lib:libpng$secondaryArchSuffix
	lib:libtiff$secondaryArchSuffix
	lib:libjpeg$secondaryArchSuffix
	lib:libcurl$secondaryArchSuffix
	lib:libxml2$secondaryArchSuffix
	lib:libz$secondaryArchSuffix
	lib:libstdc++$secondaryArchSuffix
	lib:libgcc_s$secondaryArchSuffix
"

BUILD_REQUIRES="
	haiku${secondaryArchSuffix}_devel
	mesa${secondaryArchSuffix}_devel
	devel:libsdl$secondaryArchSuffix
	devel:libpng$secondaryArchSuffix
	devel:libtiff$secondaryArchSuffix
	devel:libjpeg$secondaryArchSuffix
	devel:libcurl$secondaryArchSuffix
	devel:libxml2$secondaryArchSuffix
	devel:libz$secondaryArchSuffix
"

BUILD_PREREQUIRES="
	cmd:gcc$secondaryArchSuffix
	cmd:ld$secondaryArchSuffix
	cmd:cmake
	cmd:make
	cmd:pkg_config$secondaryArchSuffix
"

PATCHES="openscenegraph-3.2.1.patchset"

SOURCE_DIR="OpenSceneGraph-3.2.1"

BUILD()
{
	cmake . -DCMAKE_INSTALL_PREFIX=$prefix -DOSG_USE_QT=OFF -DBUILD_OSG_APPLICATIONS=OFF -DOSG_WINDOWING_SYSTEM=None
	make $jobArgs
	
}

INSTALL()
{
	make install
	
	mkdir -p $includeDir
	mv $prefix/include/* $includeDir/
	rm -rf $prefix/include
	
	mkdir -p $prefix/lib-temp
	mv $prefix/lib/* $prefix/lib-temp/
	ls $prefix/lib-temp
	mkdir -p $libDir
	mv $prefix/lib-temp/* $libDir
	rm -rf $prefix/lib-temp
	
	prepareInstalledDevelLibs libOpenThreads \
	 libosg libosgAnimation libosgDB libosgFX \
	 libosgGA libosgManipulator libosgParticle \
	 libosgPresentation libosgShadow libosgSim \
	 libosgTerrain libosgText libosgUtil libosgViewer \
	 libosgVolume libosgWidget libosgUI
	
	fixPkgconfig
	
	packageEntries devel $developDir
	
}

PROVIDES_devel="
	devel:openscenegraph$secondaryArchSuffix = $portVersion
	devel:libOpenThreads$secondaryArchSuffix = $portVersion
	devel:libosg$secondaryArchSuffix = $portVersion
	devel:libosgAnimation$secondaryArchSuffix = $portVersion
	devel:libosgDB$secondaryArchSuffix = $portVersion
	devel:libosgFX$secondaryArchSuffix = $portVersion
	devel:libosgGA$secondaryArchSuffix = $portVersion
	devel:libosgManipulator$secondaryArchSuffix = $portVersion
	devel:libosgParticle$secondaryArchSuffix = $portVersion
	devel:libosgPresentation$secondaryArchSuffix = $portVersion
	devel:libosgShadow$secondaryArchSuffix = $portVersion
	devel:libosgSim$secondaryArchSuffix = $portVersion
	devel:libosgTerrain$secondaryArchSuffix = $portVersion
	devel:libosgText$secondaryArchSuffix = $portVersion
	devel:libosgUtil$secondaryArchSuffix = $portVersion
	devel:libosgViewer$secondaryArchSuffix = $portVersion
	devel:libosgVolume$secondaryArchSuffix = $portVersion
	devel:libosgWidget$secondaryArchSuffix = $portVersion
	devel:libosgUI$secondaryArchSuffix = $portVersion
	
"
REQUIRES_devel="
	openscenegraph$secondaryArchSuffix == $portVersion
"
