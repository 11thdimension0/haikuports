SUMMARY="VLC Media Player"
DESCRIPTION="VLC is a free and open source cross-platform multimedia player \
and framework that plays most multimedia files as well as DVDs, Audio CDs, \
VCDs, and various streaming protocols."
HOMEPAGE="http://www.videolan.org/vlc/" 
SRC_URI="http://download.videolan.org/pub/videolan/vlc/2.2.1/vlc-2.2.1.tar.xz"
CHECKSUM_SHA256="543d9d7e378ec0fa1ee2e7f7f5acf8c456c7d0ecc32037171523197ef3cf1fcb"

ARCHITECTURES="x86"
if [ $effectiveTargetArchitecture != x86_gcc2 ]; then
	# x86_gcc2 is fine as primary target architecture as long as we're building
	# for a different secondary architecture.
	ARCHITECTURES="$ARCHITECTURES x86_gcc2"
fi
SECONDARY_ARCHITECTURES="x86"

REVISION="1"

PROVIDES="
	vlc$secondaryArchSuffix = $portVersion
	cmd:vlc_wrapper$secondaryArchSuffix
	cmd:vlc$secondaryArchSuffix
	cmd:rvlc$secondaryArchSuffix
	cmd:qvlc$secondaryArchSuffix
	cmd:cvlc$secondaryArchSuffix
	lib:libvlc$secondaryArchSuffix
	lib:libvlccore$secondaryArchSuffix
	"
DEPEND="
	faad2
	libdca
	libdvdnav
	libmatroska
	libmad
	a52dec
	schroedinger
	twolame
	lua
	taglib
	libbluray
	lame
	libgcrypt
	libcddb
	x264
	flac
	ffmpeg
	libsdl
	sdl-image
    xproto
    libxau
    libxcb
	"	
REQUIRES="
	haiku${secondaryArchSuffix}
	libqt4${secondaryArchSuffix} >= 4.8
	lib:libiconv$secondaryArchSuffix
	lib:libintl$secondaryArchSuffix
	lib:libstdc++$secondaryArchSuffix
	lib:libgcc_s$secondaryArchSuffix
	"
BUILD_PREREQUIRES="
	cmd:aclocal
	cmd:autoreconf
	cmd:g++${secondaryArchSuffix}	
	cmd:gettext$secondaryArchSuffix	
	cmd:libtoolize
	cmd:make
	cmd:pkg_config$secondaryArchSuffix
	cmd:xargs
	"    
BUILD_REQUIRES="
	haiku${secondaryArchSuffix}_devel
	libqt4${secondaryArchSuffix}_devel >= 4.8
	devel:liba52$secondaryArchSuffix
	devel:libgcrypt$secondaryArchSuffix
	devel:libgpg_error$secondaryArchSuffix
	devel:libiconv$secondaryArchSuffix
	devel:libmad$secondaryArchSuffix
#	devel:libpthread_stubs$secondaryArchSuffix
	devel:libswscale$secondaryArchSuffix
#	devel:libxcb$secondaryArchSuffix
	devel:libz$secondaryArchSuffix
	"
PATCH()
{
	sed -i 's/-lX11//g' modules/gui/qt4/Makefile.am
}

PATCHES="vlc-2.2.1.patch"

BUILD()
{
	bootstrap
	runConfigure ./configure --disable-rpath --disable-lua \
		--disable-avcodec --disable-xcb --enable-run-as-root
#		--bindir=$appsDir/VLC --libdir=$appsDir/VLC/lib
	sed -i 's/-Werror-implicit-function-declaration//g' src/Makefile
	make $jobArgs
}

INSTALL()
{
	make install
	
	rm -rf $dataDir/{applications,icons,kde4,vlc}
	addResourcesToBinaries $portDir/additional-files/vlc.rdef $binDir/vlc
	addAppDeskbarSymlink $binDir/vlc "VLC media player"

#	packageEntries devel \
#		$developDir
}

LICENSE="GNU GPL v2"
COPYRIGHT="1998-2015"
