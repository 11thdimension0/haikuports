SUMMARY="Free, distributed source control management tool"
DESCRIPTION="Mercurial is a free, distributed source control management tool."
HOMEPAGE="http://mercurial.selenic.com/" 
COPYRIGHT="2005-2012 Matt Mackall et al."
LICENSE="GNU GPL v2"
SRC_URI="http://mercurial.selenic.com/release/mercurial-2.2.2.tar.gz"
CHECKSUM_MD5="9f59b5d71969cbb2671702cd2a7a5a11"
REVISION="2"
ARCHITECTURES="x86_gcc2 ?x86"

PATCHES="mercurial-2.2.2.patch"

PROVIDES="
	mercurial = $portVersion compat >= 2
	cmd:hg = $portVersion compat >= 2
	"
REQUIRES="
	haiku_devel >= $haikuVersion
	python
	cmd:nano
	"
BUILD_REQUIRES="
	$REQUIRES
	gettext
	"
BUILD_PREREQUIRES="
	haiku_devel >= $haikuVersion
	cmd:aclocal
	cmd:autoconf
	cmd:gcc
	cmd:ld
	cmd:libtoolize
	cmd:make
	"

SOURCE_DIR="$portVersionedName"

BUILD()
{
	python setup.py build --force
}

INSTALL()
{
	python setup.py install \
		--prefix="$prefix" \
		--install-headers="$includedir" \
		--force
}

shopt -s extglob
TEST()
{
	cd tests
	sed -i 's,/usr/bin/env,/bin/env,' !(blacklists|bundles|gpg|svn)
	python run-tests.py
}
