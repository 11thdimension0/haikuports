From 47d5a4f5db7bb6122553320f1b12f7cef7d0ea4b Mon Sep 17 00:00:00 2001
From: Sergei Reznikov <diver@gelios.net>
Date: Tue, 11 Nov 2014 13:32:15 +0300
Subject: [PATCH] Fix makefiles

---
 vmwaddons/Makefile | 13 ++++++++++---
 vmwfs/Makefile     |  8 +++++++-
 vmwmouse/Makefile  |  8 +++++++-
 3 files changed, 24 insertions(+), 5 deletions(-)

diff --git a/vmwaddons/Makefile b/vmwaddons/Makefile
index 3e86bdc..af35f38 100644
--- a/vmwaddons/Makefile
+++ b/vmwaddons/Makefile
@@ -58,7 +58,7 @@ RSRCS=
 #		naming scheme you need to specify the path to the library
 #		and it's name
 #		library: my_lib.a entry: my_lib.a or path/my_lib.a
-LIBS= be stdc++
+LIBS= be $(STDCPPLIBS)
 
 #	specify additional paths to directories following the standard
 #	libXXX.so or libXXX.a naming scheme. You can specify full paths
@@ -103,7 +103,7 @@ SYMBOLS = TRUE
 #	specify debug settings
 #	if TRUE will allow application to be run from a source-level
 #	debugger. Note that this will disable all optimzation.
-DEBUGGER = TRUE
+#DEBUGGER = TRUE
 
 ifeq ($(RELEASE),1)
 	OPTIMIZE= FULL
@@ -131,4 +131,10 @@ APP_VERSION =
 DRIVER_PATH = 
 
 ## include the makefile-engine
-include $(BUILDHOME)/etc/makefile-engine
+DEVEL_DIRECTORY := \
+	$(shell if findpaths > /dev/null 2>&1 ; then \
+		findpaths -r "makefile_engine" B_FIND_PATH_DEVELOP_DIRECTORY ; \
+	else \
+		finddir B_SYSTEM_DEVELOP_DIRECTORY ; \
+	fi)
+include $(DEVEL_DIRECTORY)/etc/makefile-engine
diff --git a/vmwfs/Makefile b/vmwfs/Makefile
index e8aeff6..fe557c5 100644
--- a/vmwfs/Makefile
+++ b/vmwfs/Makefile
@@ -110,4 +110,10 @@ LINKER_FLAGS =
 INSTALL_DIR = /boot/home/config/add-ons/kernel/file_systems
 
 ## include the makefile-engine
-include /boot/develop/etc/makefile-engine
+DEVEL_DIRECTORY := \
+	$(shell if findpaths > /dev/null 2>&1 ; then \
+		findpaths -r "makefile_engine" B_FIND_PATH_DEVELOP_DIRECTORY ; \
+	else \
+		finddir B_SYSTEM_DEVELOP_DIRECTORY ; \
+	fi)
+include $(DEVEL_DIRECTORY)/etc/makefile-engine
diff --git a/vmwmouse/Makefile b/vmwmouse/Makefile
index 44fabc6..b728d15 100644
--- a/vmwmouse/Makefile
+++ b/vmwmouse/Makefile
@@ -132,4 +132,10 @@ APP_VERSION = 1.1.0
 DRIVER_PATH = 
 
 ## include the makefile-engine
-include $(BUILDHOME)/etc/makefile-engine
+DEVEL_DIRECTORY := \
+	$(shell if findpaths > /dev/null 2>&1 ; then \
+		findpaths -r "makefile_engine" B_FIND_PATH_DEVELOP_DIRECTORY ; \
+	else \
+		finddir B_SYSTEM_DEVELOP_DIRECTORY ; \
+	fi)
+include $(DEVEL_DIRECTORY)/etc/makefile-engine
-- 
1.8.3.4

