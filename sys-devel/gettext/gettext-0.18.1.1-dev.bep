DESCRIPTION="gettext" 
HOMEPAGE="http://www.gnu.org/software/gettext/" 
SRC_URI="http://ftp.gnu.org/pub/gnu/gettext/gettext-0.18.1.1.tar.gz"
CHECKSUM_MD5="3dd55b952826d2b32f51308f2f91aa89"
REVISION="1"
STATUS_HAIKU="broken"
DEPEND="dev-libs/gnulib = 9999"
BUILD {
	cd gettext-0.18.1.1

	if [ ! -e `haikuporter -t`/dev-libs/gnulib/work/gnulib-9999 ] ; then
		echo "gnulib not found, so updating it now..."
		haikuporter -i gnulib
	fi
	echo "Copying gnulib to gettext work directory..."
	cp -a `haikuporter -t`/dev-libs/gnulib/work/gnulib-9999/lib/binary* gettext-tools/gnulib-lib/
	cp -a `haikuporter -t`/dev-libs/gnulib/work/gnulib-9999/lib/fseek* gettext-tools/gnulib-lib/
	cp -a `haikuporter -t`/dev-libs/gnulib/work/gnulib-9999/lib/iswblank* gettext-tools/gnulib-lib/
	cp -a `haikuporter -t`/dev-libs/gnulib/work/gnulib-9999/lib/fcntl* gettext-tools/gnulib-lib/

	cp -a build-aux gettext-tools/
	cd gettext-tools
	echo "AC_CONFIG_MACRO_DIR([m4])" >> configure.ac
	libtoolize --force --copy --install
	cd ..
	libtoolize --force --copy --install
	sed -i 's/AC_INIT/AC_INIT([gettext],[0.18.1.1])/' configure.ac
	./autogen.sh --quick --skip-gnulib
	cd gettext-runtime
	sed -i 's/AC_INIT/AC_INIT([gettext-runtime],[0.18.1.1])/' configure.ac
	sed -i 's/gl_INIT_PACKAGE/dnl gl_INIT_PACKAGE was here/' configure.ac
	sed -i 's/gl_WOE32_DLL/dnl gl_WOE32_DLL was here/' configure.ac	
	echo "AC_CONFIG_MACRO_DIR([m4])" >> configure.ac
	libtoolize --force --copy --install
	autoconf -Wnone
	aclocal -I m4 -I gnulib-m4 --install --force
	libtoolize --force --copy --install
	autoconf -Wnone
	export EXTRA_CONF="--disable-java"
	cd ../
	./configure --prefix=`finddir B_COMMON_DIRECTORY`
    make
}

INSTALL {
	cd gettext-0.18.1.1
	make install
}

TEST {
	cd gettext-0.18.1.1/gettext-tools
	make check
	cd ../gettext-0.18.1.1/gettext-runtime
	make check
}

LICENSE="GNU GPL v3"
COPYRIGHT="1998, 2010 Free Software Foundation, Inc."
