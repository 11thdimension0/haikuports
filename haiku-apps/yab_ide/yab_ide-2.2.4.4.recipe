SUMMARY="An integrated development environment for yab"
DESCRIPTION="
Yab allows fast prototyping with simple and clean code. yab contains a large \
number of BeAPI specific commands for GUI creation and much, much more.

yab wouldn't be complete without the yab-IDE, a powerful development \
environment, which of course is programmed in yab itself.
"
HOMEPAGE="http://yab.orgfree.com"
SRC_URI="https://github.com/bbjimmy/YAB/archive/1.7.4.5.tar.gz"
CHECKSUM_SHA256="c3863ced3937add92e968bbbe437b5ce1d8306516e672ca319b866053899b825"

REVISION="1"
LICENSE="Artistic"
COPYRIGHT="
	1995-2006 Marc-Oliver Ihm  (yabasic)
	2006-2009 Jan Bungeroth  (yab improvements)
	2013-2015 Jim Saxton  (yab improvements)
	"

ARCHITECTURES="x86_gcc2 x86 ?x86_64"
SECONDARY_ARCHITECTURES="x86_gcc2 x86"
PROVIDES="
	yab_ide$secondaryArchSuffix = $portVersion
	app:yab_IDE = $portVersion
	"
REQUIRES="
	haiku$secondaryArchSuffix
	lib:libz$secondaryArchSuffix
	yab$secondaryArchSuffix >= 1.7.4.4
	devel:libz$secondaryArchSuffix
	"
BUILD_REQUIRES="
	haiku${secondaryArchSuffix}_devel
	devel:libz$secondaryArchSuffix
	"
BUILD_PREREQUIRES="
	cmd:bison
	cmd:flex
	cmd:gcc$secondaryArchSuffix
	cmd:make
	cmd:mkdepend
	"
SOURCE_DIR=YAB-1.7.4.5

BUILD()
{
	pushd src
	make $jobArgs BUILDHOME=`finddir B_SYSTEM_DEVELOP_DIRECTORY`
	fixattributes.sh
	popd
	pushd yab-IDE/BuildFactory
	gcc -o yab-compress yab-compress.c -lz
	popd
	mkdir -p tmp/buildfactory
	cp -r src/* tmp/buildfactory
	cp -r yab-IDE/BuildFactory/* tmp/buildfactory/
	cp yab-IDE/src/yab-IDE.yab  tmp/buildfactory/
	pushd tmp/buildfactory
	rm flex.c
	BuildFactory.yab yab-IDE yab-IDE.yab application/x-vnd.yab-IDE
	RdefApply parts/YAB-IDE.bf.rdef yab-IDE
	addattr -t mime BEOS:TYPE application/x-vnd.be-elfexecutable yab-IDE
	popd
}

INSTALL()
{
	mkdir -p $binDir
	mkdir -p $appsDir
	cp -r yab-IDE/ $appsDir/
	cp  tmp/buildfactory/yab-IDE $appsDir/yab-IDE/
	cp yab-IDE/src/yab-IDE.yab $appsDir/yab-IDE/src/
	addAppDeskbarSymlink $appsDir/yab-IDE/yab-IDE "Yab IDE"
}
