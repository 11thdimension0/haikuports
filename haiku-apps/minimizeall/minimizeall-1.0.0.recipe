SUMMARY="Minimize all your apps with the press of a button!"
DESCRIPTION="
MinimizeAll is a small app that minimizes all your apps with the press of a \
button on the Deskbar, or with a keypress. The app contains two parts: A \
standalone app that minimizes the whole app, and a replicant for your Deskbar. \
Both do the same: Minimize all your apps!
"
HOMEPAGE="https://github.com/HaikuArchives/MinimizeAll/"
SRC_URI="git://github.com/HaikuArchives/MinimizeAll.git#5f61ffe08a0e832d6f5308c9fecccbbb573972f8"

REVISION="2"

COPYRIGHT="
	2001-2008 Werner Freytag
	2009 Haiku
	"

LICENSE="MIT"

ARCHITECTURES="x86_gcc2 x86 x86_64"

PROVIDES="
	minimizeall = $portVersion
	app:MinimizeAll = $portVersion
	"

REQUIRES="
	haiku >= $haikuVersion
	"

BUILD_PREREQUIRES="
	cmd:gcc
	cmd:xres
	"

BUILD_REQUIRES="
	haiku_devel >= $haikuVersion
	"

PATCHES="minimizeall-1.0.0.patch"

BUILD()
{
	mkdir -p bin

	# Step 1 - Building the app
	cd app
	gcc -o ../bin/MinimizeAll -lbe -lstdc++ main.cpp ../minimize.cpp
	rc -o ../bin/MinimizeAll.rsrc Application.rdef
	xres -o ../bin/MinimizeAll ../bin/MinimizeAll.rsrc
	mimeset -f ../bin/MinimizeAll
	cd ..

	# Step 2 - The DeskBar AddOn!
	cd "deskbar add-on"
	gcc -o ../bin/DeskbarAddOn -lbe -lstdc++ DeskbarView.cpp ../minimize.cpp
	rc -o ../bin/DeskbarAddOn.rsrc DeskbarAddOn.rdef
	xres -o ../bin/DeskbarAddOn ../bin/DeskbarAddOn.rsrc
	mimeset -f ../bin/DeskbarAddOn
	cd ..

}

INSTALL()
{
	mkdir -p $appsDir/MinimizeAll
	cp bin/MinimizeAll $appsDir/MinimizeAll/MinimizeAll
	cp bin/DeskbarAddOn $appsDir/MinimizeAll/DeskbarAddOn
	addAppDeskbarSymlink $appsDir/MinimizeAll/MinimizeAll
	mkdir -p "$dataDir/deskbar/menu/Desktop applets"
	symlinkRelative -s "$appsDir/MinimizeAll/DeskbarAddOn"  \
		"$dataDir/deskbar/menu/Desktop applets/MinimizeAll"
}
