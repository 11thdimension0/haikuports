From a7b5180b15b148a2601eaeef786f106a9137104a Mon Sep 17 00:00:00 2001
From: Jerome Duval <jerome.duval@gmail.com>
Date: Tue, 5 Aug 2014 16:50:29 +0000
Subject: haiku patch


diff --git a/configure b/configure
index 12b0833..a1eed44 100755
--- a/configure
+++ b/configure
@@ -18251,7 +18251,7 @@ esac
 #
 # Provide information about the build.
 #
-BUILD_REVISION="8804b9a"
+BUILD_REVISION=""
 
 
 cat >>confdefs.h <<_ACEOF
@@ -18260,7 +18260,7 @@ _ACEOF
 
 
 BUILD_FILEVERSION=`echo "$VERSION" | sed 's/\([0-9.]*\).*/\1./;s/\./,/g'`
-BUILD_FILEVERSION="${BUILD_FILEVERSION}34820"
+BUILD_FILEVERSION="${BUILD_FILEVERSION}0"
 
 
 BUILD_TIMESTAMP=`date -u +%Y-%m-%dT%H:%M+0000 2>/dev/null || date`
diff --git a/configure.ac b/configure.ac
index dfbccb7..ff6b7d1 100644
--- a/configure.ac
+++ b/configure.ac
@@ -744,6 +744,7 @@ fi
 AC_SEARCH_LIBS(setsockopt, [socket], ,
 	[AC_SEARCH_LIBS(setsockopt, [socket], , , [-lnsl])])
 AC_SEARCH_LIBS(setsockopt, [nsl])
+AC_SEARCH_LIBS(socket, [network])
 
 ##################################
 #### Checks for header files. ####
-- 
1.8.3.4


From 15e722f9905d5caf4b563aca9304ec26c5851541 Mon Sep 17 00:00:00 2001
From: Jerome Duval <jerome.duval@gmail.com>
Date: Wed, 6 Aug 2014 22:08:04 +0000
Subject: gcc2 patch


diff --git a/src/hwf-x86.c b/src/hwf-x86.c
index 0591b4f..7521080 100644
--- a/src/hwf-x86.c
+++ b/src/hwf-x86.c
@@ -102,7 +102,7 @@ get_xgetbv(void)
   unsigned int t_eax;
 
   asm volatile
-    ("xgetbv\n\t"
+    (".byte 0x0f, 0x01, 0xd0\n\t"
      : "=a" (t_eax)
      : "c" (0)
     );
-- 
1.8.3.4

