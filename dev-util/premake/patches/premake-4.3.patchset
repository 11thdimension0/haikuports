From 24fb42f5d8c5e23290a9e22d577174a6151f4a6e Mon Sep 17 00:00:00 2001
From: =?UTF-8?q?Adri=C3=A1n=20Arroyo=20Calle?=
 <adrian.arroyocalle@gmail.com>
Date: Wed, 7 Jan 2015 16:17:46 +0000
Subject: Fixing Premake4


diff --git a/build/gmake.unix/Premake4.make b/build/gmake.unix/Premake4.make
index bbc159b..7cb8ce5 100644
--- a/build/gmake.unix/Premake4.make
+++ b/build/gmake.unix/Premake4.make
@@ -28,8 +28,8 @@ ifeq ($(config),release)
   CPPFLAGS  += -MMD -MP $(DEFINES) $(INCLUDES)
   CFLAGS    += $(CPPFLAGS) $(ARCH) -Wall -Os
   CXXFLAGS  += $(CFLAGS) 
-  LDFLAGS   += -s -rdynamic
-  LIBS      += -lm -ldl
+  LDFLAGS   += -s
+  LIBS      += -lbe -lroot -ltracker
   RESFLAGS  += $(DEFINES) $(INCLUDES) 
   LDDEPS    += 
   LINKCMD    = $(CC) -o $(TARGET) $(OBJECTS) $(LDFLAGS) $(RESOURCES) $(ARCH) $(LIBS)
diff --git a/src/host/lua-5.1.4/src/luaconf.h b/src/host/lua-5.1.4/src/luaconf.h
index e2cb261..b702731 100644
--- a/src/host/lua-5.1.4/src/luaconf.h
+++ b/src/host/lua-5.1.4/src/luaconf.h
@@ -55,8 +55,10 @@
 #define LUA_USE_MKSTEMP
 #define LUA_USE_ISATTY
 #define LUA_USE_POPEN
+#ifndef __HAIKU__
 #define LUA_USE_ULONGJMP
 #endif
+#endif
 
 
 /*
diff --git a/src/host/premake.h b/src/host/premake.h
index 4358b18..72371e1 100644
--- a/src/host/premake.h
+++ b/src/host/premake.h
@@ -24,6 +24,9 @@
 #elif defined(__sun__) && defined(__svr4__)
 #define PLATFORM_SOLARIS  (1)
 #define PLATFORM_STRING   "solaris"
+#elif defined(__HAIKU__)
+#define PLATFORM_LINUX	  (1)
+#define PLATFORM_STRING   "haiku"
 #else
 #define PLATFORM_WINDOWS  (1) 
 #define PLATFORM_STRING   "windows"
-- 
1.8.3.4

